<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>قاموس مصطلحات الأمن السيبراني</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/meanmenu.min.css">
    <link rel="stylesheet" href="css/magnific-popup.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/slick.min.css">
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <link rel="stylesheet" href="css/odometer.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/theme-dark.css"> <link rel="icon" type="image/png" href="assets/img/favicon.png">
    
    <style>
        /* أنماط CSS إضافية لتحسين المظهر، يمكنك دمجها في style.css */
        .ul-cards-glossary {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 20px; /* مسافة بين البطاقات */
            justify-content: flex-start;
        }
        .ul-cards-glossary li {
            flex: 0 0 calc(33.333% - 20px); /* 3 بطاقات في الصف مع مسافة */
            max-width: calc(33.333% - 20px);
            box-sizing: border-box;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex; /* لجعل محتوى البطاقة يملأ المساحة */
            flex-direction: column;
            transition: transform 0.2s ease-in-out;
        }
        .ul-cards-glossary li:hover {
            transform: translateY(-5px);
        }
        .card-wrap {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        .card-title {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        .card-text {
            color: #666;
            font-size: 1em;
            line-height: 1.6;
            flex-grow: 1; /* لجعل النص يأخذ المساحة المتاحة */
        }
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        .search-box input {
            flex-grow: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .search-box button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .search-box button:hover {
            background-color: #0056b3;
        }
        #lettersFilter {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 20px;
            justify-content: center;
        }
        #lettersFilter li {
            margin-bottom: 5px;
        }
        #lettersFilter .letters-filter-btn {
            display: block;
            padding: 8px 12px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-decoration: none;
            color: #333;
            transition: background-color 0.3s, color 0.3s;
        }
        #lettersFilter .letters-filter-btn:hover {
            background-color: #e2e6ea;
            color: #0056b3;
        }
        #lettersFilter .letters-filter-btn.active {
            background-color: #007bff;
            color: #fff;
            border-color: #007bff;
        }
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            list-style: none;
            padding: 0;
        }
        .pagination li {
            margin: 0 5px;
        }
        .pagination li a {
            display: block;
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-decoration: none;
            color: #007bff;
            transition: background-color 0.3s, color 0.3s;
        }
        .pagination li a:hover {
            background-color: #e2e6ea;
        }
        .pagination li.active a {
            background-color: #007bff;
            color: #fff;
            border-color: #007bff;
        }
        .pagination li.disabled a {
            background-color: #f8f9fa;
            color: #6c757d;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

    <header class="top-head header-1">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="main-menu">
                        <div class="menu-widget">
                            <a href="index.html" class="logo">
                                <img src="assets/img/logo.png" alt="شعار القاموس">
                            </a>
                        </div>
                        <div class="menu-container">
                            <div class="mean-menu">
                                <nav>
                                    <ul class="nav-menu">
                                        <li class="current">
                                            <a href="index.html">الرئيسية</a>
                                        </li>
                                        <li>
                                            <a href="#about-us">عن القاموس</a>
                                        </li>
                                        <li>
                                            <a href="#contact-us">اتصل بنا</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <div class="menu-widget">
                            <ul class="font-resizer">
                                <li><a href="#" class="increase-font" onclick="increaseFontSize(event)"><i class="fa fa-plus-circle"></i></a></li>
                                <li><a href="#" class="decrease-font" onclick="decreaseFontSize(event)"><i class="fa fa-minus-circle"></i></a></li>
                            </ul>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="pageContent">
        <div class="container">
            <div class="row">
                <div class="col-md-10 main-content">
                    <h3 class="PageTitle">قاموس مصطلحات الأمن السيبراني</h3>

                    <ul class="pagination col-md-12" id="lettersFilter">
                        </ul>

                    <div class="search-box mb-4">
                        <input type="text" id="searchInput" placeholder="ابحث عن مصطلح...">
                        <button id="searchBtn"><i class="fa fa-search"></i> بحث</button>
                    </div>

                    <ul class="ul-cards-glossary" id="glossaryTermsContainer">
                        </ul>

                    <ul class="pagination style2" id="paginationLinks">
                        </ul>
                </div>

                <div class="col-md-2 sm-padding glossary-sidebar">
                    <div class="sidebar-widget">
                        <h4>مصطلحات شائعة</h4>
                        <ul class="list-unstyled">
                            <li><a href="#">التهديد السيبراني</a></li>
                            <li><a href="#">التشفير</a></li>
                            <li><a href="#">جدار الحماية</a></li>
                            <li><a href="#">الهندسة الاجتماعية</a></li>
                        </ul>
                    </div>
                    </div>
            </div>
        </div>
    </div>

    <footer id="footWrapper">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 text-center">
                    <p>&copy; 2023 قاموس مصطلحات الأمن السيبراني. جميع الحقوق محفوظة.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="js/jquery-3.5.1.min.js"></script> <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.meanmenu.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/slick.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/odometer.min.js"></script>
    <script src="js/jquery.appear.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/custom.js"></script> <script>
        // تتبع الصفحة الحالية (مهم للترقيم)
        let currentPage = 1;
        // العدد الإجمالي لملفات term-X.html. يجب تحديث هذا بناءً على عدد ملفاتك الفعلية.
        const totalTermFiles = 37; 

        // --- الوظيفة الأساسية: loadTerms (تحميل المصطلحات) ---
        function loadTerms(pageNumber, searchTerm = '', letterFilter = '') {
            const termsContainer = $('#glossaryTermsContainer');
            termsContainer.empty(); // مسح المصطلحات الحالية قبل تحميل مصطلحات جديدة

            // بناء عنوان URL لملف المصطلحات (مثال: term-1.html، term-2.html)
            const fileUrl = `term-${pageNumber}.html`;

            $.get(fileUrl)
                .done(function(data) {
                    const tempDiv = $('<div>').html(data); // إنشاء div مؤقت لتحليل محتوى HTML
                    let terms = tempDiv.find('.ul-cards-glossary li'); // الحصول على جميع عناصر القائمة (البطاقات) من الملف المحمل

                    // تطبيق فلتر الحروف إذا تم اختياره
                    if (letterFilter && letterFilter !== 'الكل' && letterFilter !== '#') { // '#' للأرقام
                        terms = terms.filter(function() {
                            const title = $(this).find('.card-title').text().trim();
                            // التعامل مع الحروف العربية والأرقام
                            if (letterFilter === '#') {
                                return !isNaN(parseInt(title.charAt(0))); // التحقق مما إذا كان الحرف الأول رقمًا
                            } else {
                                return title.startsWith(letterFilter);
                            }
                        });
                    }

                    // تطبيق فلتر البحث إذا تم إدخال مصطلح بحث
                    if (searchTerm) {
                        const lowerCaseSearchTerm = searchTerm.toLowerCase();
                        terms = terms.filter(function() {
                            const termText = $(this).text().toLowerCase(); // البحث ضمن نص البطاقة بالكامل
                            return termText.includes(lowerCaseSearchTerm);
                        });
                    }

                    // إلحاق المصطلحات المفلترة أو رسالة "لا توجد نتائج"
                    if (terms.length > 0) {
                        termsContainer.append(terms);
                    } else {
                        termsContainer.append('<li class="col-md-12"><p class="card-text">لم يتم العثور على مصطلحات مطابقة للمعايير المحددة.</p></li>');
                    }

                    // تحديث الترقيم وعرض فلتر الحروف
                    updatePagination(pageNumber); 
                    updateLetterFilterUI(letterFilter); 
                    updatePageTitle(searchTerm, letterFilter, terms.length);

                })
                .fail(function() {
                    // معالجة الخطأ إذا تعذر تحميل ملف المصطلحات
                    termsContainer.html('<li class="col-md-12"><p class="card-text">حدث خطأ أثناء تحميل المصطلحات. الرجاء المحاولة مرة أخرى لاحقًا.</p></li>');
                    updatePagination(pageNumber); // لا يزال يتم تحديث الترقيم حتى في حالة الخطأ
                    updatePageTitle(searchTerm, letterFilter, 0);
                });
        }

        // --- وظائف الترقيم (Pagination) ---

        function generatePaginationLinks() {
            const paginationLinksContainer = $('#paginationLinks');
            paginationLinksContainer.empty(); // مسح الترقيم الموجود

            // زر "السابق"
            paginationLinksContainer.append(`
                <li class="prev-page ${currentPage === 1 ? 'disabled' : ''}">
                    <a href="#" data-page="${currentPage - 1}" ${currentPage === 1 ? 'onclick="return false;"' : ''}>&laquo; السابق</a>
                </li>
            `);

            // روابط أرقام الصفحات
            for (let i = 1; i <= totalTermFiles; i++) {
                paginationLinksContainer.append(`
                    <li class="${i === currentPage ? 'active' : ''}">
                        <a href="#" data-page="${i}">${i}</a>
                    </li>
                `);
            }

            // زر "التالي"
            paginationLinksContainer.append(`
                <li class="next-page ${currentPage === totalTermFiles ? 'disabled' : ''}">
                    <a href="#" data-page="${currentPage + 1}" ${currentPage === totalTermFiles ? 'onclick="return false;"' : ''}>التالي &raquo;</a>
                </li>
            `);
        }

        function updatePagination(activePage) {
            currentPage = activePage; // تعيين الصفحة الحالية
            generatePaginationLinks(); // إعادة إنشاء الروابط مع تفعيل الصفحة الجديدة

            // إضافة مستمع حدث النقر لروابط الترقيم (مفوض للمحتوى الديناميكي)
            $('#paginationLinks').off('click', 'a').on('click', 'a', function(e) {
                e.preventDefault();
                const newPage = parseInt($(this).data('page'));
                if (!isNaN(newPage) && newPage >= 1 && newPage <= totalTermFiles) {
                    loadTerms(newPage, $('#searchInput').val(), $('.letters-filter-btn.active').data('letter'));
                }
            });
        }

        // --- وظائف فلتر الأحرف (قاموس الحروف والأرقام) ---

        function generateLetterFilter() {
            const lettersFilterContainer = $('#lettersFilter');
            lettersFilterContainer.empty(); // مسح الفلاتر الموجودة

            // إضافة حرف '#' للأرقام
            const arabicLetters = ['الكل', 'أ', 'ب', 'ت', 'ث', 'ج', 'ح', 'خ', 'د', 'ذ', 'ر', 'ز', 'س', 'ش', 'ص', 'ض', 'ط', 'ظ', 'ع', 'غ', 'ف', 'ق', 'ك', 'ل', 'م', 'ن', 'ه', 'و', 'ي', '#']; 

            arabicLetters.forEach(letter => {
                lettersFilterContainer.append(`
                    <li><a href="#" class="letters-filter-btn" data-letter="${letter}">${letter}</a></li>
                `);
            });

            // إضافة مستمع حدث النقر لأزرار فلتر الأحرف
            lettersFilterContainer.off('click', '.letters-filter-btn').on('click', '.letters-filter-btn', function(e) {
                e.preventDefault();
                const selectedLetter = $(this).data('letter');
                $('#searchInput').val(''); // مسح حقل البحث عند الفرز حسب الحرف
                loadTerms(1, '', selectedLetter); // تحميل مصطلحات الصفحة الأولى مع فلتر الحرف المحدد
            });
        }

        function updateLetterFilterUI(activeLetter) {
            $('.letters-filter-btn').removeClass('active'); // إزالة فئة النشاط من جميع الأزرار
            $(`.letters-filter-btn[data-letter="${activeLetter}"]`).addClass('active'); // إضافة فئة النشاط للزر المحدد
        }

        // --- وظيفة البحث ---

        function setupSearch() {
            $('#searchBtn').on('click', function() {
                const searchTerm = $('#searchInput').val().trim();
                $('.letters-filter-btn').removeClass('active'); // مسح فلتر الحروف عند البحث
                loadTerms(1, searchTerm, ''); // تحميل مصطلحات الصفحة الأولى مع مصطلح البحث
            });

            $('#searchInput').on('keypress', function(e) {
                if (e.which === 13) { // عند الضغط على زر Enter
                    $('#searchBtn').click();
                }
            });
        }

        // --- وظيفة تحديث عنوان الصفحة ---

        function updatePageTitle(searchTerm, letterFilter, termCount) {
            let title = 'التعريفات الأمنية';
            if (searchTerm) {
                title = `نتائج البحث عن: "${searchTerm}" (${termCount} مصطلح)`;
            } else if (letterFilter && letterFilter !== 'الكل') {
                title = `مصطلحات تبدأ بحرف: ${letterFilter} (${termCount} مصطلح)`;
            } else if (letterFilter === 'الكل' || (!searchTerm && !letterFilter)) {
                title = `قاموس مصطلحات الأمن السيبراني (${termCount} مصطلح)`; // أو فقط "قاموس مصطلحات الأمن السيبراني"
            }
            $('.PageTitle').text(title);
        }

        // --- التحميل الأولي عند جاهزية المستند ---

        $(document).ready(function() {
            generateLetterFilter(); // إنشاء أزرار فلتر الأحرف مبدئيًا
            loadTerms(currentPage); // تحميل الصفحة الأولى من المصطلحات عند تحميل الصفحة
            setupSearch(); // إعداد مستمعي أحداث البحث
        });

        // وظائف تغيير حجم الخط الأصلية
        function increaseFontSize(event) {
            event.preventDefault();
            var elements = document.querySelectorAll("*");
            var fontSize;
            for (var i = 0; i < elements.length; i++) {
                fontSize = parseInt(window.getComputedStyle(elements[i]).fontSize);
                if (fontSize < 24) {
                    fontSize += 2;
                    elements[i].style.fontSize = fontSize + "px";
                }
            }
        }

        function decreaseFontSize(event) {
            event.preventDefault();
            var elements = document.querySelectorAll("*");
            var fontSize;
            for (var i = 0; i < elements.length; i++) {
                fontSize = parseInt(window.getComputedStyle(elements[i]).fontSize);
                if (fontSize > 8) {
                    fontSize -= 2;
                    elements[i].style.fontSize = fontSize + "px";
                }
            }
        }

        // سكريبت الاشتراك في النشرة الإخبارية (يمكنك نقله إلى custom.js إذا كان موجودًا لديك)
        $('form.SubScribe').on('submit', function(e) {
            e.preventDefault();
            $.ajax({
                url: 'blocks/SubscribeMailAction.php',
                method: 'POST',
                data: $(this).serialize(),
                beforeSend: function() {
                    // اختياري: إضافة مؤشر تحميل أو تعطيل زر الإرسال
                },
                success: function(response) {
                    try {
                        const result = JSON.parse(response);
                        $('input:checkbox').prop('checked', false);
                        $('#EmailAddress').val('');
                        $('#successMessage').fadeIn().html(result[0]);
                        setTimeout(function() {
                            $('#successMessage').fadeOut("Slow");
                        }, 6000);
                        $("#csrf_token").val(result[2]);
                    } catch (error) {
                        console.error("JSON Parsing Error:", error);
                    }
                },
                error: function(xhr, textStatus, error) {
                    console.error("AJAX Error:", textStatus, error);
                    $('#errorMessage').fadeIn().html("حدث خطأ. يرجى المحاولة مرة أخرى.");
                    setTimeout(function() {
                        $('#errorMessage').fadeOut("Slow");
                    }, 6000);
                },
            });
        });
    </script>
</body>
</html>
